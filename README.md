# AI Chat Persona - サブスクリプション版

AI Chat Personaは、ユーザーが独自のペルソナ（キャラクター）を作成してAIと会話を楽しめるiOSアプリです。管理者のAPIキーを使用し、サブスクリプション機能を実装することで、ユーザーの利便性を大幅に向上させました。

## 🚀 主な機能

### AI機能
- **管理者APIキー**: ユーザーが個別にAPIキーを設定する必要がありません
- **自然な会話**: Google Gemini APIを使用した自然で人間らしい対話
- **感情分析**: メッセージの感情を分析し、適切な応答を生成
- **会話の記憶**: 過去の会話を覚えて、文脈を理解した応答
- **自動トライアル**: 初回起動時に2日間の無料トライアルが自動開始

### ペルソナ機能
- **カスタムペルソナ**: 家族、友人、恋人など様々な関係性のキャラクターを作成
- **性格設定**: 性格、話し方、口癖、好きな話題を自由に設定
- **アバター**: 各ペルソナに独自のアバターを設定

### サブスクリプション機能
- **2日間無料トライアル**: 初回利用時に2日間の無料トライアル
- **月額サブスクリプション**: 月額800円でAI機能を無制限利用
- **自動課金**: 2日目以降は自動的に課金が開始
- **購入復元**: 以前の購入を復元可能
- **明確な情報表示**: 価格、期間、利用規約へのリンクを明示

## 📱 画面構成

### メイン画面
- **ペルソナ一覧**: 作成したペルソナの一覧表示
- **チャット画面**: 選択したペルソナとの会話
- **設定画面**: アプリの各種設定

### 設定画面
- **サブスクリプション管理**: 現在の状況確認と購入
- **AI詳細設定**: 応答品質、創造性、安全性の設定
- **アプリ情報**: バージョン情報など

## 🔧 技術仕様

### 使用技術
- **SwiftUI**: モダンなUIフレームワーク
- **StoreKit 2**: 最新の課金システム
- **Google Gemini API**: AI応答生成
- **UserDefaults**: ローカルデータ保存

### アーキテクチャ
- **MVVM**: Model-View-ViewModelパターン
- **Singleton**: 設定管理、サブスクリプション管理
- **ObservableObject**: SwiftUIとの連携

## 📦 ファイル構成

```
want/
├── wantApp.swift              # アプリのエントリーポイント
├── ContentView.swift          # メインコンテンツビュー
├── ChatView.swift            # チャット画面
├── ChatViewModel.swift       # チャットのビジネスロジック
├── SubscriptionManager.swift # サブスクリプション管理
├── SubscriptionView.swift    # サブスクリプション画面
├── AIConfigManager.swift     # AI設定管理
├── AIChatService.swift       # AI API通信
├── AISettingsView.swift      # AI設定画面
├── PersonaManager.swift      # ペルソナ管理
├── PersonaListView.swift     # ペルソナ一覧
├── SetupPersonaView.swift    # ペルソナ設定
└── その他のユーティリティファイル
```

## 🛠️ セットアップ

### 必要な設定
1. **管理者APIキー**: `AIConfigManager.swift`の`adminAPIKey`を実際のAPIキーに変更
2. **StoreKit設定**: App Store Connectでサブスクリプション商品を設定
3. **Bundle ID**: プロジェクトのBundle IDを適切に設定

### 開発環境
- Xcode 15.0以上
- iOS 18.5以上
- Swift 5.9以上

## 💰 課金システム

### サブスクリプション商品
- **商品ID**: `igafactory.want.premium.monthly`
- **価格**: 月額800円
- **機能**: AI機能の無制限利用

### トライアル期間
- **期間**: 2日間
- **自動課金**: トライアル終了後に自動開始
- **キャンセル**: いつでもキャンセル可能

## 🔒 セキュリティ

### APIキー管理
- 管理者のAPIキーはアプリ内にハードコード
- ユーザーの個別APIキー設定は不要
- 実際の運用では環境変数や安全な方法で管理を推奨

### データ保護
- 会話履歴はローカルに保存
- 外部サーバーへの送信は最小限
- プライバシーを重視した設計

## 📋 App Store Connect設定要件

### 必須情報
- **プライバシーポリシー**: https://tegujupe222.github.io/privacy-policy/
- **利用規約（EULA）**: https://tegujupe222.github.io/privacy-policy/terms.html
- **サブスクリプション情報**: アプリ内で明確に表示

### メタデータ設定
1. **プライバシーポリシーフィールド**: 上記URLを設定
2. **アプリ説明**: 利用規約へのリンクを含める
3. **サブスクリプション商品**: App Store Connectで適切に設定

## 🚀 今後の拡張予定

- [ ] 複数のAIプロバイダー対応
- [ ] 音声入力・出力機能
- [ ] 画像生成機能
- [ ] グループチャット機能
- [ ] クラウド同期機能

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 コントリビューション

プルリクエストやイシューの報告を歓迎します。大きな変更を行う場合は、まずイシューで議論してください。

---

**注意**: このアプリは開発・学習目的で作成されています。商用利用の際は、適切なライセンスとAPIキーの管理を行ってください。 